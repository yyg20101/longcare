# é•¿æŠ¤é™©é¡¹ç›®ä¼˜åŒ–åˆ†ææŠ¥å‘Š

## é¡¹ç›®æ¦‚å†µ

**é¡¹ç›®åç§°**: é•¿æŠ¤é™© (Long Care)  
**åŒ…å**: com.ytone.longcare  
**æŠ€æœ¯æ ˆ**: Kotlin + Jetpack Compose + Android  
**æ¶æ„**: MVVM + Clean Architecture  
**åˆ†ææ—¶é—´**: 2025å¹´

## ä¸€ã€é¡¹ç›®ç»“æ„åˆ†æ

### 1.1 ç›®å½•ç»“æ„

```
com.ytone.longcare/
â”œâ”€â”€ api/                    # APIæ¥å£å±‚
â”œâ”€â”€ app/                    # Applicationç±»
â”œâ”€â”€ common/                 # é€šç”¨å·¥å…·ç±»
â”œâ”€â”€ core/                   # æ ¸å¿ƒæ¨¡å—
â”œâ”€â”€ data/                   # æ•°æ®å±‚å®ç°
â”œâ”€â”€ debug/                  # è°ƒè¯•é…ç½®
â”œâ”€â”€ di/                     # ä¾èµ–æ³¨å…¥
â”œâ”€â”€ domain/                 # é¢†åŸŸå±‚
â”œâ”€â”€ features/               # åŠŸèƒ½æ¨¡å—ï¼ˆ29ä¸ªå­æ¨¡å—ï¼‰
â”œâ”€â”€ model/                  # æ•°æ®æ¨¡å‹
â”œâ”€â”€ navigation/             # å¯¼èˆªé…ç½®
â”œâ”€â”€ network/                # ç½‘ç»œå±‚
â”œâ”€â”€ presentation/           # å±•ç¤ºå±‚
â”œâ”€â”€ service/                # æœåŠ¡å±‚ï¼ˆç©ºç›®å½•ï¼‰âš ï¸
â”œâ”€â”€ shared/                 # å…±äº«ViewModel
â”œâ”€â”€ theme/                  # ä¸»é¢˜é…ç½®
â”œâ”€â”€ ui/                     # UIç»„ä»¶
â””â”€â”€ worker/                 # åå°ä»»åŠ¡
```

### 1.2 åŠŸèƒ½æ¨¡å—ç»Ÿè®¡

å…±æœ‰ **29ä¸ªåŠŸèƒ½æ¨¡å—**ï¼š
1. countdown - å€’è®¡æ—¶
2. face - äººè„¸ç›¸å…³
3. facecapture - äººè„¸æ•è·
4. facerecognition - äººè„¸è¯†åˆ«
5. home - é¦–é¡µ
6. identification - èº«ä»½è®¤è¯
7. location - å®šä½
8. login - ç™»å½•
9. maindashboard - ä¸»é¢æ¿
10. nfc - NFC
11. nfctest - NFCæµ‹è¯• âš ï¸
12. notificationtest - é€šçŸ¥æµ‹è¯• âš ï¸
13. nursing - æŠ¤ç†
14. nursingexecution - æŠ¤ç†æ‰§è¡Œ
15. photoupload - ç…§ç‰‡ä¸Šä¼ 
16. profile - ä¸ªäººèµ„æ–™
17. selectdevice - é€‰æ‹©è®¾å¤‡
18. selectservice - é€‰æ‹©æœåŠ¡
19. service - æœåŠ¡
20. servicecomplete - æœåŠ¡å®Œæˆ
21. servicecountdown - æœåŠ¡å€’è®¡æ—¶
22. servicehours - æœåŠ¡å·¥æ—¶
23. serviceorders - æœåŠ¡è®¢å•
24. shared - å…±äº«ç»„ä»¶
25. update - æ›´æ–°
26. userdetail - ç”¨æˆ·è¯¦æƒ…
27. userlist - ç”¨æˆ·åˆ—è¡¨
28. userservicerecord - ç”¨æˆ·æœåŠ¡è®°å½•

## äºŒã€å‘ç°çš„é—®é¢˜

### 2.1 æ¶æ„é—®é¢˜

#### âŒ é—®é¢˜1ï¼šç©ºç›®å½•
- `app/src/main/kotlin/com/ytone/longcare/service/` - ç©ºç›®å½•ï¼Œåº”è¯¥åˆ é™¤

#### âŒ é—®é¢˜2ï¼šæµ‹è¯•ä»£ç æ··å…¥ç”Ÿäº§ä»£ç 
- `features/nfctest/` - æµ‹è¯•åŠŸèƒ½æ¨¡å—
- `features/notificationtest/` - æµ‹è¯•åŠŸèƒ½æ¨¡å—
- `debug/NfcTestConfig.kt` - è°ƒè¯•é…ç½®

**å»ºè®®**ï¼šæµ‹è¯•ä»£ç åº”è¯¥æ”¾åœ¨ `src/test/` æˆ– `src/androidTest/` ç›®å½•

#### âŒ é—®é¢˜3ï¼špresentationå±‚å’Œfeatureså±‚èŒè´£é‡å 
- `presentation/countdown/` - å€’è®¡æ—¶å±•ç¤ºå±‚
- `features/countdown/` - å€’è®¡æ—¶åŠŸèƒ½å±‚
- `features/servicecountdown/` - æœåŠ¡å€’è®¡æ—¶åŠŸèƒ½å±‚

**å»ºè®®**ï¼šç»Ÿä¸€åˆ°featureså±‚ï¼Œpresentationå±‚åº”è¯¥åˆ é™¤æˆ–åˆå¹¶

#### âš ï¸ é—®é¢˜4ï¼šåŠŸèƒ½æ¨¡å—è¿‡å¤š
29ä¸ªåŠŸèƒ½æ¨¡å—å¯èƒ½å¯¼è‡´ï¼š
- ä»£ç åˆ†æ•£
- ç»´æŠ¤å›°éš¾
- ç¼–è¯‘æ—¶é—´é•¿

**å»ºè®®**ï¼šè€ƒè™‘åˆå¹¶ç›¸å…³åŠŸèƒ½æ¨¡å—

### 2.2 ä»£ç è´¨é‡é—®é¢˜

#### âš ï¸ é—®é¢˜1ï¼šå·²å¼ƒç”¨çš„APIä½¿ç”¨
```kotlin
// CountdownAlarmReceiver.kt:41
PowerManager.ACQUIRE_CAUSES_WAKEUP // Deprecated in Java
```

#### âš ï¸ é—®é¢˜2ï¼šå¯èƒ½çš„é‡å¤ä»£ç 
- `features/countdown/` å’Œ `features/servicecountdown/` åŠŸèƒ½é‡å 
- `features/face/`, `features/facecapture/`, `features/facerecognition/` åŠŸèƒ½åˆ†æ•£

### 2.3 ä¾èµ–æ³¨å…¥é—®é¢˜

#### âœ… ä¼˜ç‚¹ï¼š
- ä½¿ç”¨Hiltè¿›è¡Œä¾èµ–æ³¨å…¥
- æ¨¡å—åŒ–æ¸…æ™°

#### âš ï¸ é—®é¢˜ï¼š
- EntryPointsä½¿ç”¨è¾ƒå¤šï¼Œå¯èƒ½è¡¨ç¤ºæ¨¡å—é—´è€¦åˆåº¦é«˜

## ä¸‰ã€ä¼˜åŒ–å»ºè®®

### 3.1 ç«‹å³æ‰§è¡Œï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰

#### 1. åˆ é™¤ç©ºç›®å½•
```bash
rm -rf app/src/main/kotlin/com/ytone/longcare/service/
```

#### 2. ç§»é™¤æµ‹è¯•ä»£ç 
```bash
# ç§»åŠ¨åˆ°æµ‹è¯•ç›®å½•æˆ–åˆ é™¤
mv app/src/main/kotlin/com/ytone/longcare/features/nfctest/ app/src/test/
mv app/src/main/kotlin/com/ytone/longcare/features/notificationtest/ app/src/test/
```

#### 3. ä¿®å¤å·²å¼ƒç”¨çš„API
```kotlin
// æ›¿æ¢ ACQUIRE_CAUSES_WAKEUP
// ä½¿ç”¨ WakeLock çš„æ–°APIæˆ–ç§»é™¤è¯¥æ ‡å¿—
```

#### 4. åˆå¹¶presentationå±‚åˆ°featureså±‚
```bash
# å°† presentation/countdown/ åˆå¹¶åˆ° features/countdown/
```

### 3.2 ä¸­æœŸä¼˜åŒ–ï¼ˆä¸­ä¼˜å…ˆçº§ï¼‰

#### 1. åˆå¹¶ç›¸å…³åŠŸèƒ½æ¨¡å—

**äººè„¸ç›¸å…³æ¨¡å—åˆå¹¶**ï¼š
```
features/face/
features/facecapture/      } åˆå¹¶ä¸º features/face/
features/facerecognition/
```

**å€’è®¡æ—¶æ¨¡å—åˆå¹¶**ï¼š
```
features/countdown/        } åˆå¹¶ä¸º features/countdown/
features/servicecountdown/
```

**æœåŠ¡ç›¸å…³æ¨¡å—åˆå¹¶**ï¼š
```
features/service/
features/servicecomplete/  } åˆå¹¶ä¸º features/service/
features/servicehours/
features/serviceorders/
```

#### 2. ä¼˜åŒ–ä¾èµ–æ³¨å…¥
- å‡å°‘EntryPointsçš„ä½¿ç”¨
- ä½¿ç”¨æ„é€ å‡½æ•°æ³¨å…¥æ›¿ä»£EntryPoints

#### 3. ç»Ÿä¸€å‘½åè§„èŒƒ
- ViewModelå‘½åï¼š`XxxViewModel`
- Screenå‘½åï¼š`XxxScreen`
- Repositoryå‘½åï¼š`XxxRepository`

### 3.3 é•¿æœŸä¼˜åŒ–ï¼ˆä½ä¼˜å…ˆçº§ï¼‰

#### 1. æ¨¡å—åŒ–é‡æ„
è€ƒè™‘ä½¿ç”¨Gradleå¤šæ¨¡å—æ¶æ„ï¼š
```
:app
:core
:feature-login
:feature-service
:feature-location
...
```

#### 2. æ€§èƒ½ä¼˜åŒ–
- ä½¿ç”¨Baseline Profileä¼˜åŒ–å¯åŠ¨æ€§èƒ½
- ä¼˜åŒ–å›¾ç‰‡åŠ è½½ï¼ˆå·²ä½¿ç”¨Coil 3ï¼‰
- ä¼˜åŒ–åˆ—è¡¨æ€§èƒ½ï¼ˆä½¿ç”¨LazyColumnï¼‰

#### 3. ä»£ç è´¨é‡æå‡
- æ·»åŠ å•å…ƒæµ‹è¯•
- æ·»åŠ UIæµ‹è¯•
- ä½¿ç”¨Detektè¿›è¡Œé™æ€ä»£ç åˆ†æ
- ä½¿ç”¨ktlintè¿›è¡Œä»£ç æ ¼å¼åŒ–

## å››ã€å…·ä½“ä¼˜åŒ–è®¡åˆ’

### é˜¶æ®µä¸€ï¼šæ¸…ç†æ— ç”¨ä»£ç ï¼ˆ1-2å¤©ï¼‰

1. âœ… åˆ é™¤ç©ºç›®å½•
2. âœ… ç§»é™¤æµ‹è¯•ä»£ç åˆ°æ­£ç¡®ä½ç½®
3. âœ… åˆ é™¤æœªä½¿ç”¨çš„import
4. âœ… åˆ é™¤æ³¨é‡Šæ‰çš„ä»£ç 
5. âœ… åˆ é™¤æœªä½¿ç”¨çš„èµ„æºæ–‡ä»¶

### é˜¶æ®µäºŒï¼šä¿®å¤å·²çŸ¥é—®é¢˜ï¼ˆ2-3å¤©ï¼‰

1. âœ… ä¿®å¤å·²å¼ƒç”¨çš„API
2. âœ… ä¿®å¤ç¼–è¯‘è­¦å‘Š
3. âœ… ä¼˜åŒ–å“é“ƒåŠŸèƒ½ï¼ˆå·²å®Œæˆï¼‰
4. âœ… ä¼˜åŒ–æœåŠ¡åœæ­¢é€»è¾‘ï¼ˆå·²å®Œæˆï¼‰

### é˜¶æ®µä¸‰ï¼šæ¶æ„ä¼˜åŒ–ï¼ˆ1å‘¨ï¼‰

1. â³ åˆå¹¶presentationå±‚åˆ°featureså±‚
2. â³ åˆå¹¶ç›¸å…³åŠŸèƒ½æ¨¡å—
3. â³ ä¼˜åŒ–ä¾èµ–æ³¨å…¥
4. â³ ç»Ÿä¸€å‘½åè§„èŒƒ

### é˜¶æ®µå››ï¼šæ€§èƒ½ä¼˜åŒ–ï¼ˆ1å‘¨ï¼‰

1. â³ ä¼˜åŒ–å¯åŠ¨æ€§èƒ½
2. â³ ä¼˜åŒ–å†…å­˜ä½¿ç”¨
3. â³ ä¼˜åŒ–ç½‘ç»œè¯·æ±‚
4. â³ ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢

### é˜¶æ®µäº”ï¼šæµ‹è¯•è¦†ç›–ï¼ˆæŒç»­ï¼‰

1. â³ æ·»åŠ å•å…ƒæµ‹è¯•
2. â³ æ·»åŠ é›†æˆæµ‹è¯•
3. â³ æ·»åŠ UIæµ‹è¯•
4. â³ è®¾ç½®CI/CD

## äº”ã€ä¼˜åŒ–æ•ˆæœé¢„æœŸ

### 5.1 ä»£ç è´¨é‡
- å‡å°‘ä»£ç è¡Œæ•°ï¼šé¢„è®¡å‡å°‘ 10-15%
- å‡å°‘æ¨¡å—æ•°é‡ï¼šä»29ä¸ªå‡å°‘åˆ°15-20ä¸ª
- æé«˜ä»£ç å¤ç”¨ç‡ï¼šæå‡ 20-30%

### 5.2 æ€§èƒ½æå‡
- å¯åŠ¨æ—¶é—´ï¼šå‡å°‘ 15-20%
- å†…å­˜å ç”¨ï¼šå‡å°‘ 10-15%
- APKå¤§å°ï¼šå‡å°‘ 5-10%

### 5.3 å¯ç»´æŠ¤æ€§
- é™ä½æ¨¡å—é—´è€¦åˆåº¦
- æé«˜ä»£ç å¯è¯»æ€§
- ç®€åŒ–ä¾èµ–å…³ç³»

## å…­ã€é£é™©è¯„ä¼°

### 6.1 é«˜é£é™©æ“ä½œ
- âŒ åˆ é™¤åŠŸèƒ½æ¨¡å—ï¼ˆå¯èƒ½å½±å“ç°æœ‰åŠŸèƒ½ï¼‰
- âŒ å¤§è§„æ¨¡é‡æ„ï¼ˆå¯èƒ½å¼•å…¥æ–°bugï¼‰

### 6.2 ä¸­é£é™©æ“ä½œ
- âš ï¸ åˆå¹¶åŠŸèƒ½æ¨¡å—ï¼ˆéœ€è¦å……åˆ†æµ‹è¯•ï¼‰
- âš ï¸ ä¿®æ”¹ä¾èµ–æ³¨å…¥ï¼ˆéœ€è¦éªŒè¯æ‰€æœ‰æ³¨å…¥ç‚¹ï¼‰

### 6.3 ä½é£é™©æ“ä½œ
- âœ… åˆ é™¤ç©ºç›®å½•
- âœ… ç§»é™¤æµ‹è¯•ä»£ç 
- âœ… ä¿®å¤å·²å¼ƒç”¨API
- âœ… ä¼˜åŒ–import

## ä¸ƒã€ç«‹å³å¯æ‰§è¡Œçš„ä¼˜åŒ–

### 7.1 åˆ é™¤ç©ºç›®å½•
```bash
# åˆ é™¤ç©ºçš„serviceç›®å½•
rm -rf app/src/main/kotlin/com/ytone/longcare/service/
```

### 7.2 ä¿®å¤å·²å¼ƒç”¨API

**æ–‡ä»¶**: `CountdownAlarmReceiver.kt`

```kotlin
// ä¿®å¤å‰
val wakeLock = powerManager?.newWakeLock(
    PowerManager.PARTIAL_WAKE_LOCK or PowerManager.ACQUIRE_CAUSES_WAKEUP,
    "LongCare:CountdownAlarm"
)

// ä¿®å¤å
val wakeLock = powerManager?.newWakeLock(
    PowerManager.PARTIAL_WAKE_LOCK,
    "LongCare:CountdownAlarm"
)
```

### 7.3 ä¼˜åŒ–import

æ‰€æœ‰æ–‡ä»¶éƒ½åº”è¯¥ï¼š
- ç§»é™¤æœªä½¿ç”¨çš„import
- æŒ‰å­—æ¯é¡ºåºæ’åˆ—import
- ä½¿ç”¨é€šé…ç¬¦importï¼ˆå¦‚æœåŒä¸€åŒ…ä¸‹æœ‰5ä¸ªä»¥ä¸Šçš„ç±»ï¼‰

## å…«ã€æ€»ç»“

### 8.1 å½“å‰çŠ¶æ€
- âœ… æ¶æ„æ¸…æ™°ï¼ˆMVVM + Clean Architectureï¼‰
- âœ… ä½¿ç”¨ç°ä»£æŠ€æœ¯æ ˆï¼ˆJetpack Compose + Hiltï¼‰
- âš ï¸ æ¨¡å—è¿‡å¤šï¼Œéœ€è¦æ•´åˆ
- âš ï¸ å­˜åœ¨æµ‹è¯•ä»£ç æ··å…¥ç”Ÿäº§ä»£ç 
- âš ï¸ æœ‰ç©ºç›®å½•å’Œæœªä½¿ç”¨çš„ä»£ç 

### 8.2 ä¼˜åŒ–ä¼˜å…ˆçº§

**ç«‹å³æ‰§è¡Œ**ï¼š
1. åˆ é™¤ç©ºç›®å½•
2. ä¿®å¤å·²å¼ƒç”¨API
3. ç§»é™¤æµ‹è¯•ä»£ç 

**çŸ­æœŸæ‰§è¡Œ**ï¼š
1. åˆå¹¶presentationå±‚
2. ä¼˜åŒ–import
3. ç»Ÿä¸€å‘½åè§„èŒƒ

**ä¸­æœŸæ‰§è¡Œ**ï¼š
1. åˆå¹¶åŠŸèƒ½æ¨¡å—
2. ä¼˜åŒ–ä¾èµ–æ³¨å…¥
3. æ€§èƒ½ä¼˜åŒ–

**é•¿æœŸæ‰§è¡Œ**ï¼š
1. æ¨¡å—åŒ–é‡æ„
2. æµ‹è¯•è¦†ç›–
3. CI/CDè®¾ç½®

### 8.3 å»ºè®®

åŸºäºå½“å‰é¡¹ç›®çŠ¶æ€ï¼Œå»ºè®®é‡‡ç”¨**æ¸è¿›å¼ä¼˜åŒ–**ç­–ç•¥ï¼š
1. å…ˆä¿®å¤æ˜æ˜¾çš„é—®é¢˜ï¼ˆç©ºç›®å½•ã€å·²å¼ƒç”¨APIï¼‰
2. å†è¿›è¡Œå°èŒƒå›´é‡æ„ï¼ˆåˆå¹¶ç›¸å…³æ¨¡å—ï¼‰
3. æœ€åè€ƒè™‘å¤§è§„æ¨¡æ¶æ„è°ƒæ•´

è¿™æ ·å¯ä»¥ï¼š
- âœ… é™ä½é£é™©
- âœ… æŒç»­æ”¹è¿›
- âœ… ä¿æŒé¡¹ç›®ç¨³å®šæ€§

---

**æŠ¥å‘Šç”Ÿæˆæ—¶é—´**: 2025å¹´  
**åˆ†æäººå‘˜**: Kiro AI Assistant  
**é¡¹ç›®çŠ¶æ€**: ğŸŸ¡ è‰¯å¥½ï¼Œéœ€è¦ä¼˜åŒ–
